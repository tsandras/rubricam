<%= simple_form_for(@personnage) do |p| %>
  <% if @personnage.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@personnage.errors.count, "error") %> prohibited this personnage from being saved:</h2>
      <ul>
      <% @personnage.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div id="personnage">
    <div id="menu">
      <a href="javascript:;" class="close"></a>
      <%#= input_xps_et_bonus(p) %>
      <%= recherche_historique(p) %>
      <%= recherche_atout(p) %>
      <%= recherche_discipline(p) %>
      <%= recherche_capacite(p) %>
    </div>
    <div id="page">
      <%= button_tag('', type: 'button', id: "show_menu", class: 'menu_btn') %>
      <%= button_tag('', type: 'button', id: "show_menu", class: 'menu_btn2') %>
      <div class="row">
        <p class="text-center"><%= show_partie(@personnage) %></p>
      </div>
      <div class="row info-general">
        <p class="text-center"><b>Générale</b></p>
        <%= input_info_general(p, @personnage) %>
      </div>
      <div class="row attributs">
        <%= image_tag("barre_fiche.png", class: 'barre') %>
        <p class="titre"><b>Attributs</b></p>
        <p><%= show_nbs_attributs(@personnage) %></p>
        <%= input_attributs(p, @personnage) %>
      </div>
      <div class="row capacites">
        <%= image_tag("barre_fiche.png", class: 'barre') %>
        <p class="titre2"><b>Capacités</b></p>
        <p><%= show_nbs_capacites(@personnage) %></p>
        <%= input_capacite(@capacites_personnages, @personnage) %>
        <%= image_tag("barre_fiche.png", class: 'barre') %>
      </div>
      <% if @personnage.mage? %>
        <div class="row spheres">
          <p class="text-center"><b>Sphères</b></p>
          <%= input_spheres(@personnage) %>
        </div>
      <% end %>
      <div class="row disciplines">
        <p class="text-center"><b>Disciplines</b><%= show_disciplines(@personnage) %></p>
        <%= input_discipline(@disciplines_personnages) %>
      </div>
      <div class="row autre">
        <p class="text-center"><b>Autres</b></p>
        <div class="col-md-4">
          <%= input_historique(@historiques_personnages, @personnage) %>
          <%= input_atout(@atouts_personnages) %>
        </div>
        <div class="col-md-4">
          <p class="text-center"><b>Important</b></p>
          <%= input_voie(p, @personnage) %>
          <%= input_entelechie(p, @personnage) %>
          <%= input_volonte(p) %>
        </div>
        <div class="col-md-4">
          <p class="text-center"><b>Vertues/Résonnances</b><%= show_nbs_vertues(@personnage) %></p>
          <%= input_vertue(p, @personnage) %>
          <%= input_resonnance(p, @personnage) %>
        </div>
      </div>
      <div class="row background">
        <p class="text-center"><b>Background</b></p>
        <div class="col-md-4">
          <%= p.input :background %>
        </div>
        <div class="col-md-4">
          <%= p.input :paradygme %>
        </div>
        <div class="col-md-4">
          <%= p.input :description %>
        </div>
      </div>
      <!--
        <%#= button_tag "Calculer", type: "button", id: "calculer", class: "btn btn-primary" %>
       -->
      <div class="row background">
        <%= p.input :caracteristique_base, as: :hidden %>
        <%= p.input :caracteristique_bonus, as: :hidden %>
        <p class="text-center"><%= show_sauvegarder(p, @personnage) %></p>
      </div>
    </div>
  </div>
<% end %>
<script type="text/javascript">
  $(document).ready(function() {
    $('.datepicker').datepicker();
    manageCheckBox("#search_capacite", ".capacite .checkbox .check_boxes");
    manageCheckBox("#search_historique", ".historique .checkbox .check_boxes");
    manageCheckBox("#search_atout", ".atout .checkbox .check_boxes");
    manageCheckBox("#search_discipline", ".discipline .checkbox .check_boxes");
    manageCapacites(".capacite .checkbox .check_boxes", ".cap");
    manageHistoriques(".historique .checkbox .check_boxes", ".his");
    manageAtouts(".atout .checkbox .check_boxes", ".ato");
    manageDisciplines(".discipline .checkbox .check_boxes", ".dis");
    whenclickCalculeXpsDep($("#personnage_type_perso").val(), "#calculer");
    listenerAllAttributs();
    listenerAllCapacites();
    listenerAllSpheres();
    listenerAllDisciplines();
    listenerAllHistoriques();
    listenerEntelechie("#personnage_entelechie");
    listenerVolonte("#personnage_volonte");
    listenerVertues();
    listenerResonnances();
    listenerPhysiqueForBase(1, 10);
    listenerMentalForBase(1, 10);
    listenerSocialForBase(1, 10);
    listenerTypeCapacitesForBase("Talent", "#nbs_talents", 0, 10);
    listenerTypeCapacitesForBase("Compétence", "#nbs_competences", 0, 10);
    listenerTypeCapacitesForBase("Connaissance", "#nbs_connaissances", 0, 10);
    listenerHistoriquesForBase(0);
    listenerDisciplinesForBase();
    listenerVertuesForBase();
    manageMenu();
  });
</script>
